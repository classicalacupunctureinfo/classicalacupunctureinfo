<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Five Elements</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#071c1f;
  color:#e9fbff;
}
header{
  padding:16px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
  background:#0b2b2f;
  border-bottom:1px solid rgba(255,255,255,.08);
}

/* GRID */
#grid{
  padding:14px;
}
.tile{
  background:#0f3a3f;
  border-radius:16px;
  padding:18px;
  margin-bottom:14px;
  text-align:center;
  font-size:18px;
  font-weight:bold;
  letter-spacing:.4px;
  border-left:6px solid #36c2c9;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
}

/* DETAIL */
#detail{
  display:none;
  padding:14px;
}
.back{
  margin-bottom:12px;
  padding:12px;
  text-align:center;
  background:#123c40;
  border-radius:12px;
  font-size:13px;
}
.card{
  background:#0f3a3f;
  border-radius:16px;
  padding:16px;
  border-left:6px solid #36c2c9;
}
.card h2{
  margin:0 0 6px;
  font-size:22px;
}
.season{
  font-size:12px;
  opacity:.7;
  margin-bottom:10px;
}
.section{
  margin-bottom:10px;
}
.label{
  font-size:11px;
  opacity:.6;
  text-transform:uppercase;
}
.value{
  font-size:13px;
  line-height:1.45;
}

/* DYSFUNCTION */
.dys{
  margin-top:12px;
  padding:10px;
  border:1px dashed rgba(255,255,255,.25);
  border-radius:12px;
  background:rgba(255,255,255,.04);
}
.dys-title{
  font-size:12px;
  font-weight:bold;
  margin-bottom:6px;
}
.badge{
  display:inline-block;
  padding:4px 10px;
  margin:4px 6px 0 0;
  font-size:11px;
  border-radius:999px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.18);
}
</style>
</head>

<body>

<header>Five Elements</header>

<!-- GRID -->
<div id="grid"></div>

<!-- DETAIL -->
<div id="detail">
  <div class="back" onclick="showGrid()">← Back to Elements</div>
  <div id="detailBox"></div>
</div>

<script>
(function(){

  var elements = [];

  /* ===== LOAD JSON (OLD ANDROID SAFE) ===== */
  var xhr = new XMLHttpRequest();
  xhr.open("GET", "five_elements.json", true);
  xhr.onreadystatechange = function(){
    if(xhr.readyState === 4){
      if(xhr.status === 200){
        elements = JSON.parse(xhr.responseText);
        buildGrid();
      }else{
        alert("Unable to load five_elements.json");
      }
    }
  };
  xhr.send(null);

  function buildGrid(){
    var grid = document.getElementById("grid");
    grid.innerHTML = "";

    for(var i=0;i<elements.length;i++){
      (function(i){
        var e = elements[i];
        var tile = document.createElement("div");
        tile.className = "tile";
        tile.style.borderLeftColor = e.COLOUR.toLowerCase();
        tile.innerHTML = e.ELEMENT;
        tile.onclick = function(){
          showDetail(i);
        };
        grid.appendChild(tile);
      })(i);
    }
  }

  window.showDetail = function(i){
    document.getElementById("grid").style.display = "none";
    document.getElementById("detail").style.display = "block";

    var e = elements[i];
    document.getElementById("detailBox").innerHTML =
      "<div class='card' style='border-left-color:"+e.COLOUR.toLowerCase()+"'>" +
        "<h2>"+e.ELEMENT+"</h2>" +
        "<div class='season'>"+e.SEASON+"</div>" +
        section("Internal Organs", e["INTERNAL  ORGAN"]) +
        section("External Organ", e["EXTERNAL  ORGAN"]) +
        section("Provides Energy", e["PROVIDES ENERGY"]) +
        section("Maintains", e.MAINTAINS) +
        section("Functions", e["VARIOUS FUNCTIONS"]) +
        dysfunction(e) +
      "</div>";
  };

  window.showGrid = function(){
    document.getElementById("detail").style.display = "none";
    document.getElementById("grid").style.display = "block";
  };

  function section(label, text){
    return "<div class='section'><div class='label'>"+label+"</div><div class='value'>"+fmt(text)+"</div></div>";
  }

  function fmt(text){
    var parts = text.split("\n");
    var out = [];
    for(var i=0;i<parts.length;i++){
      var t = parts[i].replace("•","").trim();
      if(t){ out.push(t); }
    }
    return out.join(", ");
  }

  function dysfunction(e){
    var h="<div class='dys'><div class='dys-title'>When Element Is Dysfunctional</div>";
    h+="<span class='badge'>Colour: "+e.COLOUR+"</span>";
    h+=badges("Taste",e.TASTE);
    h+=badges("Emotion",e.EMOTION);
    h+="</div>";
    return h;
  }

  function badges(label, text){
    var p=text.split("\n"),o="";
    for(var i=0;i<p.length;i++){
      var t=p[i].trim();
      if(t){
        o+="<span class='badge'>"+label+": "+t+"</span>";
      }
    }
    return o;
  }

})();
</script>

</body>
</html>
