<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Five Elements Dashboard</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1b33;
      --muted:#9fb0cc;
      --text:#e8eefc;
      --line:rgba(255,255,255,.08);
      --accent:#5eead4;
      --shadow: 0 18px 40px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(94,234,212,.18), transparent 60%),
                  radial-gradient(900px 500px at 100% 10%, rgba(96,165,250,.15), transparent 55%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
    }
    .wrap{max-width:1100px;margin:0 auto;padding:22px}
    header{
      display:flex;flex-wrap:wrap;gap:14px;align-items:flex-end;justify-content:space-between;
      margin-bottom:18px
    }
    .title{
      display:flex;flex-direction:column;gap:4px
    }
    h1{margin:0;font-size:22px;letter-spacing:.2px}
    .sub{margin:0;color:var(--muted);font-size:13px}
    .controls{
      display:flex;gap:10px;align-items:center;flex-wrap:wrap;
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      padding:12px;border-radius:var(--radius);
      box-shadow: var(--shadow);
    }
    label{font-size:12px;color:var(--muted)}
    select{
      appearance:none;
      background:rgba(255,255,255,.05);
      border:1px solid var(--line);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      font-size:14px;
      min-width:220px;
      outline:none;
    }
    .hint{
      color:var(--muted);
      font-size:12px;
      padding:2px 0 0 0;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr 2fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
      select{min-width: 240px;}
    }

    .card{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
    }
    .cardHead h2{
      margin:0;font-size:14px;font-weight:650;letter-spacing:.2px
    }
    .pill{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(94,234,212,.08);
      color:var(--accent);
      white-space:nowrap;
    }
    .cardBody{padding:14px 16px}

    .emptyState{
      color:var(--muted);
      line-height:1.4;
      font-size:13px;
      border:1px dashed rgba(255,255,255,.15);
      border-radius:16px;
      padding:14px;
    }

    .kv{
      display:grid;
      grid-template-columns: 140px 1fr;
      gap:10px 14px;
      padding:14px 16px;
    }
    @media (max-width: 520px){
      .kv{grid-template-columns: 1fr}
    }
    .k{
      color:var(--muted);
      font-size:12px;
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    .v{
      font-size:14px;
      line-height:1.35;
      white-space:pre-wrap;
    }
    .rowSep{border-top:1px solid var(--line)}
    .footerNote{
      margin-top:14px;
      color:var(--muted);
      font-size:12px;
      opacity:.95;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Characteristics of the Five Elements</h1>
        <p class="sub">Select an element to view its full row of data.</p>
      </div>

      <div class="controls">
        <div style="display:flex;flex-direction:column;gap:6px">
          <label for="elementSelect">Element</label>
          <select id="elementSelect">
            <option value="">— Select an element —</option>
          </select>
          <div class="hint" id="statusHint">No selection</div>
        </div>
      </div>
    </header>

    <main class="grid">
      <section class="card">
        <div class="cardHead">
          <h2>Selection</h2>
          <span class="pill" id="selectedPill">None</span>
        </div>
        <div class="cardBody">
          <div class="emptyState" id="emptyLeft">
            Choose an element from the dropdown to display its details.
          </div>

          <div id="selectionSummary" style="display:none">
            <div class="kv">
              <div class="k">Colour</div>
              <div class="v" id="selColour"></div>

              <div class="k">Emotion</div>
              <div class="v" id="selEmotion"></div>

              <div class="k">Season</div>
              <div class="v" id="selSeason"></div>

              <div class="k">Taste</div>
              <div class="v" id="selTaste"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="cardHead">
          <h2>Element Data</h2>
          <span class="pill" id="rowPill">Waiting…</span>
        </div>

        <div class="cardBody">
          <div class="emptyState" id="emptyRight">
            No data to show yet. Select an element to load its row.
          </div>

          <div id="rowDetails" style="display:none"></div>

          <div class="footerNote">
            Tip: Line breaks and bullet points are preserved for readability.
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const DATA_URL = "./five_elements.json";

    const elSelect = document.getElementById("elementSelect");
    const selectedPill = document.getElementById("selectedPill");
    const rowPill = document.getElementById("rowPill");
    const statusHint = document.getElementById("statusHint");

    const emptyLeft = document.getElementById("emptyLeft");
    const emptyRight = document.getElementById("emptyRight");
    const selectionSummary = document.getElementById("selectionSummary");
    const rowDetails = document.getElementById("rowDetails");

    const selColour = document.getElementById("selColour");
    const selEmotion = document.getElementById("selEmotion");
    const selSeason = document.getElementById("selSeason");
    const selTaste  = document.getElementById("selTaste");

    let DB = [];

    function normalizeText(s){
      return String(s ?? "")
        .replace(/\r\n/g, "\n")
        .replace(/\r/g, "\n")
        .trim();
    }

    function clearUI(){
      selectedPill.textContent = "None";
      rowPill.textContent = "Waiting…";
      statusHint.textContent = "No selection";

      emptyLeft.style.display = "";
      emptyRight.style.display = "";

      selectionSummary.style.display = "none";
      rowDetails.style.display = "none";
      rowDetails.innerHTML = "";
    }

    function renderRow(item){
      // Left summary
      emptyLeft.style.display = "none";
      selectionSummary.style.display = "";

      selectedPill.textContent = item.ELEMENT;
      statusHint.textContent = "Selected: " + item.ELEMENT;

      selColour.textContent = normalizeText(item["COLOUR"]);
      selEmotion.textContent = normalizeText(item["EMOTION"]);
      selSeason.textContent = normalizeText(item["SEASON"]);
      selTaste.textContent  = normalizeText(item["TASTE"]);

      // Right details
      emptyRight.style.display = "none";
      rowDetails.style.display = "";
      rowPill.textContent = item.ELEMENT + " row";

      const keys = Object.keys(item);

      rowDetails.innerHTML = keys.map((k, idx) => {
        const v = normalizeText(item[k]);
        return `
          <div class="kv ${idx === 0 ? "" : "rowSep"}">
            <div class="k">${k}</div>
            <div class="v">${v || "—"}</div>
          </div>
        `;
      }).join("");
    }

    async function init(){
      clearUI();
      try{
        const res = await fetch(DATA_URL, { cache: "no-store" });
        if(!res.ok) throw new Error("Failed to load JSON (" + res.status + ")");
        DB = await res.json();

        // Fill dropdown
        DB.forEach(row => {
          const opt = document.createElement("option");
          opt.value = row.ELEMENT;
          opt.textContent = row.ELEMENT;
          elSelect.appendChild(opt);
        });

      }catch(err){
        statusHint.textContent = "Error loading data";
        rowPill.textContent = "Load failed";
        emptyRight.textContent =
          "Could not load five_elements.json. If you are using GitHub Pages, make sure the JSON file is in the same folder as index.html.";
        console.error(err);
      }
    }

    elSelect.addEventListener("change", () => {
      const value = elSelect.value;
      if(!value){
        clearUI();
        return;
      }
      const item = DB.find(x => x.ELEMENT === value);
      if(!item){
        clearUI();
        statusHint.textContent = "No matching element found";
        return;
      }
      renderRow(item);
    });

    init();
  </script>
</body>
</html>
