<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Five Elements ‚Äî Deep Teal Edition</title>
  <style>
    :root {
      /* Refined Dark Teal Palette (Default) */
      --bg: #041c1c;
      --bg-gradient: radial-gradient(circle at top center, #083333, #041c1c);
      --surface: #0a2e2e;
      --card-bg: rgba(13, 54, 54, 0.7);
      --border: rgba(20, 184, 166, 0.2);
      --text-main: #e2f1f1;
      --text-muted: #94b2b2;
      --accent: #2dd4bf; 
      --accent-glow: rgba(45, 212, 191, 0.3);
      --radius: 16px;
      --shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
    }

    [data-theme="light"] {
      --bg: #f0f7f7;
      --bg-gradient: radial-gradient(circle at top center, #ffffff, #e6eeee);
      --surface: #ffffff;
      --card-bg: rgba(255, 255, 255, 0.8);
      --border: rgba(20, 184, 166, 0.15);
      --text-main: #132a2a;
      --text-muted: #5a7a7a;
      --accent: #0d9488;
      --accent-glow: rgba(13, 148, 136, 0.1);
      --shadow: 0 12px 40px rgba(0, 50, 50, 0.1);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg-gradient);
      background-color: var(--bg);
      color: var(--text-main);
      min-height: 100vh;
      padding: 40px 20px;
      display: flex;
      justify-content: center;
      line-height: 1.6;
      transition: background 0.4s ease, color 0.4s ease;
    }

    .container { width: 100%; max-width: 900px; animation: fadeIn 0.6s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    .lead { display: flex; gap: 24px; align-items: flex-start; justify-content: space-between; margin-bottom: 32px; flex-wrap: wrap; }
    h1 { font-size: 28px; font-weight: 800; letter-spacing: -0.5px; margin: 0; background: linear-gradient(to right, var(--text-main), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    p.sub { margin: 4px 0 0; color: var(--text-muted); font-size: 14px; }

    .selectorWrap { display: flex; gap: 16px; align-items: flex-end; flex-wrap: wrap; }
    label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: var(--accent); font-weight: 700; margin-bottom: 6px; display: block; }

    select {
      min-width: 260px;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--surface);
      color: var(--text-main);
      font-size: 15px;
      outline: none;
      cursor: pointer;
      transition: all 0.2s;
    }

    button {
      background: var(--surface);
      border: 1px solid var(--border);
      padding: 10px 18px;
      border-radius: 10px;
      cursor: pointer;
      color: var(--text-main);
      font-size: 13px;
      font-weight: 600;
      transition: all 0.2s;
    }

    button:hover { border-color: var(--accent); background: var(--accent-glow); }
    #refreshBtn { background: var(--accent-glow); border-color: var(--accent); }

    .theme-toggle { width: 44px; height: 24px; background: var(--surface); border: 1px solid var(--border); border-radius: 20px; position: relative; cursor: pointer; display: flex; align-items: center; }
    .theme-toggle::after { content: 'üåô'; position: absolute; left: 4px; font-size: 12px; transition: 0.3s; }
    [data-theme="light"] .theme-toggle::after { content: '‚òÄÔ∏è'; left: 24px; }

    .card { background: var(--card-bg); backdrop-filter: blur(12px); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; }
    .cardHead { padding: 24px; background: rgba(0, 0, 0, 0.05); border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
    .cardBody { padding: 32px; }
    .pill { font-size: 12px; font-weight: 700; padding: 6px 14px; border-radius: 20px; background: var(--accent-glow); color: var(--accent); border: 1px solid var(--accent); text-transform: uppercase; }
    .section-heading { font-size: 14px; font-weight: 800; color: var(--accent); text-transform: uppercase; letter-spacing: 1.5px; margin: 32px 0 16px; padding-bottom: 8px; border-bottom: 2px solid var(--border); display: block; }
    .kv { display: grid; grid-template-columns: 180px 1fr; gap: 12px 24px; align-items: start; }
    .k { color: var(--accent); font-size: 11px; font-weight: 700; text-transform: uppercase; opacity: 0.8; }
    .v { font-size: 16px; color: var(--text-main); white-space: pre-wrap; }
    .rowSep { border-top: 1px solid var(--border); padding-top: 20px; margin-top: 20px; }
    .placeholder { text-align: center; padding: 40px 0; color: var(--text-muted); font-style: italic; }
  </style>
</head>
<body>
  <div class="container">
    <header class="lead">
      <div class="title">
        <h1>Five Elements</h1>
        <p class="sub">Explore the deep properties of the elemental dataset.</p>
      </div>
      <div class="theme-toggle" id="themeToggle" title="Toggle Mode"></div>
    </header>

    <div class="selectorWrap" style="margin-bottom: 32px;">
      <div>
        <label for="elementSelect">Filter by Element</label>
        <select id="elementSelect" disabled>
          <option value="" selected disabled>Loading...</option>
        </select>
      </div>

      <div style="display:flex; flex: 1; justify-content: flex-end; align-items: flex-end; gap: 10px;">
        <div style="text-align: right;">
          <span id="statusText" class="small">Initializing...</span>
          <div style="display:flex; gap:10px; margin-top: 8px;">
            <button id="refreshBtn">Refresh</button>
            <button id="resetBtn">Reset</button>
          </div>
        </div>
      </div>
    </div>

    <main class="card">
      <div class="cardHead">
        <div><strong id="cardTitle">Data Inspector</strong><div class="small" id="subNote">Awaiting selection...</div></div>
        <div class="pill" id="elementPill">Standby</div>
      </div>
      <div class="cardBody">
        <div id="emptyState" class="placeholder">Select an element to inspect.</div>
        <div id="rowContainer" style="display:none"></div>
      </div>
    </main>
  </div>

  <script>
    const selectEl = document.getElementById("elementSelect");
    const statusText = document.getElementById("statusText");
    const elementPill = document.getElementById("elementPill");
    const emptyState = document.getElementById("emptyState");
    const rowContainer = document.getElementById("rowContainer");
    const resetBtn = document.getElementById("resetBtn");
    const refreshBtn = document.getElementById("refreshBtn");
    const subNote = document.getElementById("subNote");
    const themeToggle = document.getElementById("themeToggle");

    let DB = [];

    function initTheme() {
      const saved = localStorage.getItem("five_elements_theme") || "dark";
      document.documentElement.setAttribute("data-theme", saved);
    }

    themeToggle.onclick = () => {
      const current = document.documentElement.getAttribute("data-theme");
      const target = current === "light" ? "dark" : "light";
      document.documentElement.setAttribute("data-theme", target);
      localStorage.setItem("five_elements_theme", target);
    };

    function escapeHtml(s) {
      return String(s ?? "").replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#39;");
    }

    function renderRow(item) {
      elementPill.textContent = item.ELEMENT || "‚Äî";
      subNote.textContent = "Complete record for " + item.ELEMENT;
      const groupKeys = ["EMOTION", "COLOUR", "TASTE"];
      let html = "";
      
      Object.keys(item).filter(k => !groupKeys.includes(k)).forEach((k, idx) => {
        html += `<div class="kv ${idx === 0 ? "" : "rowSep"}"><div class="k">${escapeHtml(k)}</div><div class="v">${escapeHtml(item[k] || "‚Äî")}</div></div>`;
      });
      html += `<div class="section-heading">When the element malfunctions</div>`;
      groupKeys.forEach((k, idx) => {
        html += `<div class="kv ${idx === 0 ? "" : "rowSep"}"><div class="k">${escapeHtml(k)}</div><div class="v">${escapeHtml(item[k] || "‚Äî")}</div></div>`;
      });

      rowContainer.innerHTML = html;
      emptyState.style.display = "none";
      rowContainer.style.display = "";
    }

    async function loadData() {
      statusText.textContent = "Syncing...";
      selectEl.disabled = true;
      try {
        const assetUrl = new URL("five_elements.json", window.location.href).href;
        const res = await fetch(assetUrl, { cache: "no-store" });
        if (!res.ok) throw new Error("Fetch failed");
        
        DB = await res.json();
        selectEl.innerHTML = '<option value="" selected disabled>‚Äî Select an element ‚Äî</option>';
        DB.forEach(row => {
          const opt = document.createElement("option");
          opt.value = row.ELEMENT;
          opt.textContent = row.ELEMENT;
          selectEl.appendChild(opt);
        });
        
        selectEl.disabled = false;
        statusText.textContent = "System Ready ‚úÖ";
      } catch (err) {
        statusText.textContent = "Error ‚ùå";
        emptyState.textContent = "Could not load five_elements.json.";
      }
    }

    selectEl.onchange = () => {
      const item = DB.find(r => r.ELEMENT === selectEl.value);
      if (item) renderRow(item);
    };

    resetBtn.onclick = () => {
      selectEl.value = "";
      rowContainer.style.display = "none";
      emptyState.style.display = "";
      elementPill.textContent = "Standby";
      subNote.textContent = "Awaiting selection...";
    };

    refreshBtn.onclick = loadData;

    initTheme();
    loadData();
  </script>
</body>
</html>
